IF OBJECT_ID('STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG') IS NOT NULL
  DROP TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG;

CREATE TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG
(
  S_ACCOUNT_KEY                       DECIMAL(38,0)    	  NOT NULL    IDENTITY(1,1),
  S_CREATE_DATETIME                   DATETIME2           NOT NULL,
  S_UPDATE_DATETIME                   DATETIME2           NOT NULL,
  ACCOUNTID                           VARCHAR(255)        NOT NULL,
  ASC_TOTALASSETS                     DECIMAL(19,4),
  PARENTACCOUNTID                     VARCHAR(255),
  PARENTACCOUNTIDNAME                 VARCHAR(160),
  OWNERID                             VARCHAR(255),
  OWNERIDNAME                         VARCHAR(160),
  ASC_VIPCATEGORY                     DECIMAL(10,0),
  NAME                                VARCHAR(160),
  ASC_SONATACLIENTID                  VARCHAR(100),
  ASC_SONATAOUTLETID                  VARCHAR(100),
  ASC_SONATAOUTLETTYPE                VARCHAR(100),
  NEW_TEAM_TEAM                       VARCHAR(50),
  ACCOUNTCATEGORYCODE                 DECIMAL(10,0),
  ASC_SONATASTATUS                    VARCHAR(100),
  CUSTOMERTYPECODE                    DECIMAL(10,0),
  TELEPHONE1                          VARCHAR(50),
  FAX                                 VARCHAR(50),
  WEBSITEURL                          VARCHAR(200),
  EMAILADDRESS1                       VARCHAR(100),
  ASC_PARENTCOMPANYID                 VARCHAR(255),
  ASC_PARENTCOMPANYIDNAME             VARCHAR(160),
  ASC_HIGHPRIORITY                    DECIMAL(1,0),
  ASC_RISKLEVEL                       DECIMAL(10,0),
  ASC_CAUSEOFRISK                     DECIMAL(10,0),
  ASC_VIPSETBYID                      VARCHAR(255),
  ASC_VIPSETBYIDNAME                  VARCHAR(200),
  ASC_VIPSETDATE                      DATETIME2,
  ASC_REASONFORVIPSTATUS              VARCHAR(MAX),
  ASC_SUBSEGMENT                      DECIMAL(10,0),
  ASC_SALESREGION                     DECIMAL(10,0),
  ASC_PCADMIN                         VARCHAR(255),
  NEW_VALIDATED                       DECIMAL(1,0),
  NEW_REFERENCEVALIDATEDBYID          VARCHAR(255),
  NEW_REFERENCEVALIDATEDBYIDNAME      VARCHAR(200),
  NEW_VALIDATEDDATE                   DATETIME2,
  ASC_ADVISINGONSTRUCTUREDDEPOSITS    DECIMAL(1,0),
  ASC_INTROCALLREQUESTED              DECIMAL(1,0),
  ASC_INTROCALLREQUESTEDDATE          DATETIME2,
  ASC_INTROCALLCOMPLETED              DECIMAL(1,0),
  ASC_INTROCALLCOMPLETEDDATE          DATETIME2,
  ASC_AWAITINGAPPLICATION             DECIMAL(1,0),
  NEW_BROKER_BROKER                   VARCHAR(20),
  ADDRESS1_COMPOSITE                  VARCHAR(MAX),
  NEW_BROKER_BASE_COUNTRY             VARCHAR(10),
  NEW_BROKER_BASE_CY                  VARCHAR(10),
  NEW_FINANCIALDATE                   DATETIME2,
  NEW_FINANCIALPENDINGPURCHASES       DECIMAL(23,10),
  NEW_FINANCIALCLIENTCOUNT            DECIMAL(10,0),
  NEW_FINANCIALCASH                   DECIMAL(23,10),
  NEW_FINANCIALFREEASSETS             DECIMAL(23,10),
  NEW_FINANCIALTOTALASSETS            DECIMAL(23,10),
  ASC_SONATAFINANCIALSDATE            DATETIME2,
  ASC_SONATAPENDINGPURCHASES          DECIMAL(19,4),
  ASC_SONATAFINANCIALSCLIENTCOUNT     DECIMAL(10,0),
  ASC_SONATAFINANCIALSCASH            DECIMAL(19,4),
  ASC_SONATAFINANCIALSFREEASSETS      DECIMAL(19,4),
  ASC_SONATAFINANCIALSTOTALASSETS     DECIMAL(19,4),
  ASC_BDTEAM                          DECIMAL(10,0),
  ASC_BDCCONTACTID                    VARCHAR(255),
  ASC_BDCCONTACTIDNAME                VARCHAR(200),
  ASC_BRANDED                         DECIMAL(10,0),
  ASC_BRANDEDLOGINPAGE                VARCHAR(200),
  ASC_ENGAGEMENTDATE                  DATETIME2,
  ASC_INCEPTIONDATE                   DATETIME2,
  ASC_FIRMFSA                         VARCHAR(20),
  NEW_TEAM_FSA_NO                     VARCHAR(20),
  NEW_TEAM_FIRM_CODE                  VARCHAR(20),
  ASC_PARENTGROUP                     VARCHAR(200),
  NEW_REFERENCECSTEAMID               VARCHAR(255),
  ASC_CSCONTACTID                     VARCHAR(255),
  ASC_CSCONTACTIDNAME                 VARCHAR(200),
  ASC_FIRMTYPE                        DECIMAL(10,0),
  ASC_LINKEDFSA                       VARCHAR(20),
  ASC_REGULATORYSTATUS                DECIMAL(10,0),
  ASC_REGULATORYBODYID                VARCHAR(255),
  ASC_REGULATORYBODYIDNAME            VARCHAR(160),
  ASC_MATRIXSTATUS                    DECIMAL(10,0),
  ASC_NOOFRIS                         DECIMAL(10,0),
  ASC_MATRIXFIRMNAME                  VARCHAR(200),
  NEW_PROSPECTADDRESSNAME             VARCHAR(200),
  NEW_PROSPECTADDRESSLINE1            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE2            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE3            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE4            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE5            VARCHAR(200),
);


ALTER TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG 
  ADD CONSTRAINT DF_CRM_PLAT_DYN_ACCOUNT_STG_S_CREATE_DATETIME DEFAULT CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'GMT Standard Time' AS DATETIME2) FOR S_CREATE_DATETIME ; 


ALTER TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG 
  ADD CONSTRAINT DF_CRM_PLAT_DYN_ACCOUNT_STG_S_UPDATE_DATETIME DEFAULT CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'GMT Standard Time' AS DATETIME2) FOR S_UPDATE_DATETIME ; 
