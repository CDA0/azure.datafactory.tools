IF OBJECT_ID('STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG') IS NOT NULL
  DROP TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG;

CREATE TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG
(
  S_ACCOUNT_KEY                       DECIMAL(38,0)    NOT NULL    IDENTITY(1,1),
  S_CREATE_DATETIME                   DATETIME2        NOT NULL,
  S_UPDATE_DATETIME                   DATETIME2        NOT NULL,
  ACCOUNTID                           VARCHAR(255)     NOT NULL,
  ASC_TOTALASSETS                     DECIMAL(19,4),
  PARENTACCOUNTID                     VARCHAR(255),
  PARENTACCOUNTIDNAME                 VARCHAR(160),
  OWNERID                             VARCHAR(255),
  OWNERIDNAME                         VARCHAR(160),
  ASC_VIPCATEGORY                     DECIMAL(10,0),
  NAME                                VARCHAR(160),
  ASC_SONATACLIENTID                  VARCHAR(100),
  ASC_SONATAOUTLETID                  VARCHAR(100),
  ASC_SONATAOUTLETTYPE                VARCHAR(100),
  NEW_TEAM_TEAM                       VARCHAR(50),
  ACCOUNTCATEGORYCODE                 DECIMAL(10,0),
  ASC_SONATASTATUS                    VARCHAR(100),
  CUSTOMERTYPECODE                    DECIMAL(10,0),
  TELEPHONE1                          VARCHAR(50),
  FAX                                 VARCHAR(50),
  WEBSITEURL                          VARCHAR(200),
  EMAILADDRESS1                       VARCHAR(100),
  ASC_PARENTCOMPANYID                 VARCHAR(255),
  ASC_PARENTCOMPANYIDNAME             VARCHAR(160),
  ASC_HIGHPRIORITY                    DECIMAL(1,0),
  ASC_RISKLEVEL                       DECIMAL(10,0),
  ASC_CAUSEOFRISK                     DECIMAL(10,0),
  ASC_VIPSETBYID                      VARCHAR(255),
  ASC_VIPSETBYIDNAME                  VARCHAR(200),
  ASC_VIPSETDATE                      DATETIME2,
  ASC_REASONFORVIPSTATUS              VARCHAR(MAX),
  ASC_SUBSEGMENT                      DECIMAL(10,0),
  ASC_SALESREGION                     DECIMAL(10,0),
  ASC_PCADMIN                         VARCHAR(255),
  NEW_VALIDATED                       DECIMAL(1,0),
  NEW_REFERENCEVALIDATEDBYID          VARCHAR(255),
  NEW_REFERENCEVALIDATEDBYIDNAME      VARCHAR(200),
  NEW_VALIDATEDDATE                   DATETIME2,
  ASC_ADVISINGONSTRUCTUREDDEPOSITS    DECIMAL(1,0),
  ASC_INTROCALLREQUESTED              DECIMAL(1,0),
  ASC_INTROCALLREQUESTEDDATE          DATETIME2,
  ASC_INTROCALLCOMPLETED              DECIMAL(1,0),
  ASC_INTROCALLCOMPLETEDDATE          DATETIME2,
  ASC_AWAITINGAPPLICATION             DECIMAL(1,0),
  NEW_BROKER_BROKER                   VARCHAR(20),
  ADDRESS1_COMPOSITE                  VARCHAR(MAX),
  NEW_BROKER_BASE_COUNTRY             VARCHAR(10),
  NEW_BROKER_BASE_CY                  VARCHAR(10),
  NEW_FINANCIALDATE                   DATETIME2,
  NEW_FINANCIALPENDINGPURCHASES       DECIMAL(23,10),
  NEW_FINANCIALCLIENTCOUNT            DECIMAL(10,0),
  NEW_FINANCIALCASH                   DECIMAL(23,10),
  NEW_FINANCIALFREEASSETS             DECIMAL(23,10),
  NEW_FINANCIALTOTALASSETS            DECIMAL(23,10),
  ASC_SONATAFINANCIALSDATE            DATETIME2,
  ASC_SONATAPENDINGPURCHASES          DECIMAL(19,4),
  ASC_SONATAFINANCIALSCLIENTCOUNT     DECIMAL(10,0),
  ASC_SONATAFINANCIALSCASH            DECIMAL(19,4),
  ASC_SONATAFINANCIALSFREEASSETS      DECIMAL(19,4),
  ASC_SONATAFINANCIALSTOTALASSETS     DECIMAL(19,4),
  ASC_BDTEAM                          DECIMAL(10,0),
  ASC_BDCCONTACTID                    VARCHAR(255),
  ASC_BDCCONTACTIDNAME                VARCHAR(200),
  ASC_BRANDED                         DECIMAL(10,0),
  ASC_BRANDEDLOGINPAGE                VARCHAR(200),
  ASC_ENGAGEMENTDATE                  DATETIME2,
  ASC_INCEPTIONDATE                   DATETIME2,
  ASC_FIRMFSA                         VARCHAR(20),
  NEW_TEAM_FSA_NO                     VARCHAR(20),
  NEW_TEAM_FIRM_CODE                  VARCHAR(20),
  ASC_PARENTGROUP                     VARCHAR(200),
  NEW_REFERENCECSTEAMID               VARCHAR(255),
  ASC_CSCONTACTID                     VARCHAR(255),
  ASC_CSCONTACTIDNAME                 VARCHAR(200),
  ASC_FIRMTYPE                        DECIMAL(10,0),
  ASC_LINKEDFSA                       VARCHAR(20),
  ASC_REGULATORYSTATUS                DECIMAL(10,0),
  ASC_REGULATORYBODYID                VARCHAR(255),
  ASC_REGULATORYBODYIDNAME            VARCHAR(160),
  ASC_MATRIXSTATUS                    DECIMAL(10,0),
  ASC_NOOFRIS                         DECIMAL(10,0),
  ASC_MATRIXFIRMNAME                  VARCHAR(200),
  NEW_PROSPECTADDRESSNAME             VARCHAR(200),
  NEW_PROSPECTADDRESSLINE1            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE2            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE3            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE4            VARCHAR(200),
  NEW_PROSPECTADDRESSLINE5            VARCHAR(200),
  NEW_PROSPECTADDRESSCOUNTRY          VARCHAR(100),
  TERRITORYID                         VARCHAR(255),
  NEW_PROSPECTPHONEWORK               VARCHAR(100),
  ASC_TWITTERUSERID                   VARCHAR(100),
  ASC_TWITTERURL                      VARCHAR(200),
  NEW_SHAREPOINTFOLDERCONTROL         VARCHAR(100),
  NEW_REFERENCEMANUALLYCREATEDBYID    VARCHAR(255),
  NEW_REFERENCEMANUALLYCREATEDBYIDNAME VARCHAR(200),
  CREATEDBY                           VARCHAR(255),
  CREATEDBYNAME                       VARCHAR(200),
  MODIFIEDBY                          VARCHAR(255),
  MODIFIEDBYNAME                      VARCHAR(200),
  CREATEDON                           DATETIME2,
  MODIFIEDON                          DATETIME2,
  TRANSACTIONCURRENCYID               VARCHAR(255),
  ORIGINATINGLEADID                   VARCHAR(255),
  CREDITLIMIT                         DECIMAL(19,4),
  CREDITONHOLD                        DECIMAL(1,0),
  PAYMENTTERMSCODE                    DECIMAL(10,0),
  DEFAULTPRICELEVELID                 VARCHAR(255),
  DONOTEMAIL                          DECIMAL(1,0),
  DONOTBULKEMAIL                      DECIMAL(1,0),
  DONOTPHONE                          DECIMAL(1,0),
  DONOTFAX                            DECIMAL(1,0),
  DONOTPOSTALMAIL                     DECIMAL(1,0),
  DONOTSENDMM                         DECIMAL(1,0),
  LASTUSEDINCAMPAIGN                  DATETIME2,
  PREFERREDCONTACTMETHODCODE          DECIMAL(10,0),
  PREFERREDSYSTEMUSERID               VARCHAR(255),
  PREFERREDAPPOINTMENTDAYCODE         DECIMAL(10,0),
  PREFERREDSERVICEID                  VARCHAR(255),
  PREFERREDAPPOINTMENTTIMECODE        DECIMAL(10,0),
  NEW_UPDATEDBYBLUEBUTTONON           DATETIME2,
  ASC_LASTUPDATEDBYSONATAON           DATETIME2,
  ADDRESS1_LINE1                      VARCHAR(255),
  ADDRESS1_LINE2                      VARCHAR(255),
  ADDRESS1_LINE3                      VARCHAR(255),
  ADDRESS1_CITY                       VARCHAR(255),
  ADDRESS1_COUNTY                     VARCHAR(255),
  ADDRESS1_POSTALCODE                 VARCHAR(255),
  ADDRESS1_COUNTRY                    VARCHAR(255),
  PRIMARYCONTACTID                    VARCHAR(255),
  PRIMARYCONTACTIDNAME                VARCHAR(255),
  ADDRESS1_NAME                       VARCHAR(255),
  NEW_TRUST_TRUSTEE_NAME              VARCHAR(255),
  NEW_TRUST_NAME                      VARCHAR(255),
  NEW_PROSPECTEMAIL                   VARCHAR(100),
  NEW_PROSPECTPHONEHOME               VARCHAR(100),
  NEW_PROSPECTPHONEMOBILE             VARCHAR(100),
  NEW_PROSPECTADDRESSPOSTCODE         VARCHAR(100),
  DERIVEDMSDYNFIRMSEQID               VARCHAR(100),
  FIRSTNAME							              VARCHAR(255),
  LASTNAME							              VARCHAR(255),
  MIDDLENAME 						              VARCHAR(255)
);

ALTER TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG 
  ADD CONSTRAINT DF_CRM_PLAT_DYN_ACCOUNT_STG_S_CREATE_DATETIME DEFAULT CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'GMT Standard Time' AS DATETIME2) FOR S_CREATE_DATETIME; 
  
ALTER TABLE STAGE_CDI.CRM_PLAT_DYN_ACCOUNT_STG 
  ADD CONSTRAINT DF_CRM_PLAT_DYN_ACCOUNT_STG_S_UPDATE_DATETIME DEFAULT CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'GMT Standard Time' AS DATETIME2) FOR S_UPDATE_DATETIME; 
  